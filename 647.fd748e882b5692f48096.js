(self.webpackChunkgoatzilla=self.webpackChunkgoatzilla||[]).push([[647],{5647:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DataSharingModule:()=>$});var i=n(9171),a=n(665),r=n(4297),c=n(6287),o=n(784),s=n(7716),l=n(6231),p=n(6226),g=n(8583);let u=(()=>{class e{constructor(e){this.projectService=e,this.activeProject$=this.projectService.getActiveProject()}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.ProjectsService))},e.\u0275cmp=s.Xpm({type:e,selectors:[["app-share-itinerary"]],decls:20,vars:3,consts:[[1,"centered-content","padded-container"],[1,"mb-2","mt-1"],["routerLink","../../../../","cta","tertiary"],[1,"ml-1","mr-1"],["routerLink","../../../","cta","tertiary"],["routerLink","../../","cta","tertiary"]],template:function(e,t){if(1&e&&(s.TgZ(0,"main",0),s._UZ(1,"app-authenticated-header"),s.TgZ(2,"header",1),s.TgZ(3,"span"),s.TgZ(4,"a",2),s._uU(5," Dashboard "),s.qZA(),s.qZA(),s.TgZ(6,"span",3),s._uU(7," / "),s.qZA(),s.TgZ(8,"span"),s.TgZ(9,"a",4),s._uU(10),s.ALo(11,"async"),s.qZA(),s.qZA(),s.TgZ(12,"span",3),s._uU(13," / "),s.qZA(),s.TgZ(14,"span"),s.TgZ(15,"a",5),s._uU(16,"Sharing center"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(17,"article"),s.TgZ(18,"p"),s._uU(19,"Send itinerary information to participants"),s.qZA(),s.qZA(),s.qZA()),2&e){let e;s.xp6(10),s.Oqu(null==(e=s.lcZ(11,1,t.activeProject$))?null:e.name)}},directives:[p.W,i.yS],pipes:[g.Ov],styles:[""],changeDetection:0}),e})(),d=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Xpm({type:e,selectors:[["app-itinerary"]],decls:2,vars:0,template:function(e,t){1&e&&(s.TgZ(0,"p"),s._uU(1,"itinerary works!"),s.qZA())},styles:[""]}),e})(),Z=(()=>{class e{constructor(e){this.projectService=e,this.activeProject$=this.projectService.getActiveProject()}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.ProjectsService))},e.\u0275cmp=s.Xpm({type:e,selectors:[["app-sharing-dashboard"]],decls:17,vars:3,consts:[[1,"centered-content","padded-container"],[1,"mb-3","mt-1"],["routerLink","../../","cta","tertiary"],[1,"ml-1","mr-1"],["routerLink","../","cta","tertiary"],[1,"mb-2"]],template:function(e,t){if(1&e&&(s.TgZ(0,"main",0),s._UZ(1,"app-authenticated-header"),s.TgZ(2,"header",1),s.TgZ(3,"span"),s.TgZ(4,"a",2),s._uU(5," Dashboard "),s.qZA(),s.qZA(),s.TgZ(6,"span",3),s._uU(7," / "),s.qZA(),s.TgZ(8,"span"),s.TgZ(9,"a",4),s._uU(10),s.ALo(11,"async"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(12,"article"),s.TgZ(13,"p",5),s._uU(14,"Keeps a list of sent emails"),s.qZA(),s.TgZ(15,"p"),s._uU(16,"And also a list of upcoming automatic emails"),s.qZA(),s.qZA(),s.qZA()),2&e){let e;s.xp6(10),s.Oqu(null==(e=s.lcZ(11,1,t.activeProject$))?null:e.name)}},directives:[p.W,i.yS],pipes:[g.Ov],styles:[""],changeDetection:0}),e})(),h=(()=>{class e{constructor(e){this.projectService=e,this.activeProject$=this.projectService.getActiveProject()}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.ProjectsService))},e.\u0275cmp=s.Xpm({type:e,selectors:[["app-share-booking"]],decls:20,vars:3,consts:[[1,"centered-content","padded-container"],[1,"mb-2","mt-1"],["routerLink","../../../../","cta","tertiary"],[1,"ml-1","mr-1"],["routerLink","../../../","cta","tertiary"],["routerLink","../../","cta","tertiary"]],template:function(e,t){if(1&e&&(s.TgZ(0,"main",0),s._UZ(1,"app-authenticated-header"),s.TgZ(2,"header",1),s.TgZ(3,"span"),s.TgZ(4,"a",2),s._uU(5," Dashboard "),s.qZA(),s.qZA(),s.TgZ(6,"span",3),s._uU(7," / "),s.qZA(),s.TgZ(8,"span"),s.TgZ(9,"a",4),s._uU(10),s.ALo(11,"async"),s.qZA(),s.qZA(),s.TgZ(12,"span",3),s._uU(13," / "),s.qZA(),s.TgZ(14,"span"),s.TgZ(15,"a",5),s._uU(16,"Sharing center"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(17,"article"),s.TgZ(18,"p"),s._uU(19,"Send an email with detailed booking information"),s.qZA(),s.qZA(),s.qZA()),2&e){let e;s.xp6(10),s.Oqu(null==(e=s.lcZ(11,1,t.activeProject$))?null:e.name)}},directives:[p.W,i.yS],pipes:[g.Ov],styles:[""],changeDetection:0}),e})();var m=n(5917),A=n(8002),f=n(7057),T=n(4762),v=n(6215),q=n(9112),y=n(2608),k=n(4785),b=n(800),_=n(2458);function x(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"button",7),s.NdJ("click",function(){return s.CHM(e),s.oxw().makeLink.emit()}),s._UZ(1,"svg-icon",8),s.TgZ(2,"span"),s._uU(3,"Generate link"),s.qZA(),s.qZA()}}function U(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"button",9),s.NdJ("click",function(){return s.CHM(e),s.oxw().onCopy()}),s._UZ(1,"svg-icon",8),s.TgZ(2,"span"),s._uU(3,"Copy link"),s.qZA(),s.qZA()}if(2&e){const e=s.oxw();s.Q6J("cdkCopyToClipboard",e.code)}}function S(e,t){if(1&e&&(s.TgZ(0,"mat-option",21),s._uU(1),s.qZA()),2&e){const e=t.$implicit;s.Q6J("value",e),s.xp6(1),s.hij(" ",e," ")}}function C(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",22),s.TgZ(1,"span",23),s._uU(2),s.qZA(),s.TgZ(3,"button",24),s.NdJ("click",function(t){const n=s.CHM(e).$implicit;return s.oxw(2).removeRecipient(t,n)}),s._UZ(4,"svg-icon",25),s.qZA(),s.qZA()}if(2&e){const e=t.$implicit;s.xp6(2),s.Oqu(e)}}function w(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",10),s.TgZ(1,"div",11),s.TgZ(2,"input",12,13),s.NdJ("keyup.enter",function(){s.CHM(e);const t=s.MAs(3),n=s.oxw();return n.handleEnter(n.emailFilter),t.focus()})("ngModelChange",function(t){return s.CHM(e),s.oxw().emailFilter=t}),s.qZA(),s.TgZ(4,"mat-autocomplete",14,15),s.NdJ("optionSelected",function(t){return s.CHM(e),s.oxw().toggleRecipient(t.option.value)}),s.YNc(6,S,2,2,"mat-option",16),s.ALo(7,"async"),s.qZA(),s.TgZ(8,"div",17),s.YNc(9,C,5,1,"div",18),s.qZA(),s.TgZ(10,"div",19),s.TgZ(11,"button",20),s.NdJ("click",function(){s.CHM(e);const t=s.oxw();return t.handleShare(t.displayedRecipients)}),s._uU(12," Done "),s.qZA(),s.qZA(),s.qZA(),s.qZA()}if(2&e){const e=s.MAs(5),t=s.oxw();s.xp6(2),s.Q6J("ngModel",t.emailFilter)("matAutocomplete",e),s.xp6(4),s.Q6J("ngForOf",s.lcZ(7,4,t.recipients$)),s.xp6(3),s.Q6J("ngForOf",t.displayedRecipients)}}class O{constructor(e){this.snackbar=e,this.makeLink=new s.vpe,this.shareLink=new s.vpe,this.code="",this.emails=[],this.emailFilter$=new v.X(""),this.showEmailSharing=!1,this._recipients$=new v.X([]),this.recipients$=(0,q.aj)([this._recipients$,this.emailFilter$]).pipe((0,A.U)(([e,t])=>t?e.filter(e=>e.includes(t)):[])),this.displayedRecipients=[],this.emailFilter=""}handleShare(e){this.shareLink.emit(e),this.showEmailSharing=!1}handleEnter(e){this.displayedRecipients=Array.from(new Set([...this.displayedRecipients,e])),this.emailFilter=""}removeRecipient(e,t){e.stopPropagation(),this.displayedRecipients=this.displayedRecipients.filter(e=>e!==t)}toggleRecipient(e){this.displayedRecipients.includes(e),this.displayedRecipients.push(e)}toggleEmailSharing(){this.showEmailSharing=!this.showEmailSharing}onCopy(){this.snackbar.open("Share link was copied!","",{duration:3e3})}ngOnInit(){this._recipients$.next(this.emails)}}O.\u0275fac=function(e){return new(e||O)(s.Y36(r.ux))},O.\u0275cmp=s.Xpm({type:O,selectors:[["app-share-settings"]],inputs:{code:"code",emails:"emails"},outputs:{makeLink:"makeLink",shareLink:"shareLink"},decls:10,vars:3,consts:[[1,"flex","wrap","align-center","space-between"],["cta","outlined","class","flex align-center justify-center mobile-mb-2",3,"click",4,"ngIf"],["cta","outlined","class","flex align-center justify-center",3,"cdkCopyToClipboard","click",4,"ngIf"],[1,"email-share"],["cta","outlined",1,"flex","align-center","justify-center",3,"click"],["key","share",1,"mr-1"],["class","email-share-toggable",4,"ngIf"],["cta","outlined",1,"flex","align-center","justify-center","mobile-mb-2",3,"click"],["key","link",1,"mr-1"],["cta","outlined",1,"flex","align-center","justify-center",3,"cdkCopyToClipboard","click"],[1,"email-share-toggable"],[1,"flex","wrap"],["type","text","placeholder","Search recipients",1,"input","ml-1",3,"ngModel","matAutocomplete","keyup.enter","ngModelChange"],["input",""],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"mt-2"],["class","flex align-center",4,"ngFor","ngForOf"],[1,"mt-4"],["cta","outlined",3,"click"],[3,"value"],[1,"flex","align-center"],[1,"mr-1"],[1,"ghost-button","remove-recipient",3,"click"],["key","remove"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0),s.TgZ(1,"div"),s.YNc(2,x,4,0,"button",1),s.YNc(3,U,4,1,"button",2),s.qZA(),s.TgZ(4,"div",3),s.TgZ(5,"button",4),s.NdJ("click",function(){return t.toggleEmailSharing()}),s._UZ(6,"svg-icon",5),s.TgZ(7,"span"),s._uU(8,"Share with"),s.qZA(),s.qZA(),s.YNc(9,w,13,6,"div",6),s.qZA(),s.qZA()),2&e&&(s.xp6(2),s.Q6J("ngIf",!t.code),s.xp6(1),s.Q6J("ngIf",t.code),s.xp6(6),s.Q6J("ngIf",t.showEmailSharing))},directives:[g.O5,y.bk,k.i3,a.Fj,b.ZL,a.JJ,a.On,b.XC,g.sg,_.ey],pipes:[g.Ov],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   .email-share[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:relative}[_nghost-%COMP%]   .email-share-toggable[_ngcontent-%COMP%]{position:absolute;top:50px;background-color:#fff;min-width:300px;padding:var(--space-3);box-shadow:0 4px 8px 0 #0003}@media (max-width:48em){[_nghost-%COMP%]   .email-share-toggable[_ngcontent-%COMP%]{min-width:100%}}[_nghost-%COMP%]   .clear-date[_ngcontent-%COMP%], [_nghost-%COMP%]   .remove-recipient[_ngcontent-%COMP%]{color:var(--secondary-color)}"]}),(0,T.gn)([(0,r.GU)((e,t)=>{!1===e&&(t.displayedRecipients=[])})],O.prototype,"showEmailSharing",void 0),(0,T.gn)([(0,r.GU)((e,t)=>{t.emailFilter$.next(e)})],O.prototype,"emailFilter",void 0);const P=function(e){return["../../..","itinerary",e]};function M(e,t){if(1&e&&(s.TgZ(0,"tr"),s.TgZ(1,"td"),s.TgZ(2,"a",3),s._uU(3),s.qZA(),s.qZA(),s.TgZ(4,"td",4),s._uU(5),s.ALo(6,"currency"),s.qZA(),s.TgZ(7,"td",4),s._uU(8),s.qZA(),s.TgZ(9,"td",4),s._uU(10),s.ALo(11,"currency"),s.qZA(),s.qZA()),2&e){const e=t.$implicit,n=s.oxw();s.xp6(2),s.Q6J("routerLink",s.VKq(12,P,e.id)),s.xp6(1),s.AsE("",e.provider," / ",e.confirmationNumber,""),s.xp6(2),s.hij(" ",s.xi3(6,6,e.price,e.currencyCode)," "),s.xp6(3),s.Oqu(e.participants.length),s.xp6(2),s.hij(" ",s.xi3(11,9,n.getBookingTotal(e),e.currencyCode)," ")}}let j=(()=>{class e{constructor(){this.bookings=[]}getBookingTotal(e){return(e.participants.length*e.price).toFixed(2)}getAllBookingsTotal(e){return e.reduce((e,t)=>e+t.participants.length*t.price,0).toFixed(2)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Xpm({type:e,selectors:[["app-price-report-visualization"]],inputs:{bookings:"bookings"},decls:19,vars:5,consts:[[1,"mb-4","table"],[4,"ngFor","ngForOf"],[1,"bold","mr-2"],["cta","tertiary",3,"routerLink"],[1,"centered"]],template:function(e,t){1&e&&(s.TgZ(0,"table",0),s.TgZ(1,"thead"),s.TgZ(2,"tr"),s.TgZ(3,"th"),s._uU(4,"Booking"),s.qZA(),s.TgZ(5,"th"),s._uU(6,"Price"),s.qZA(),s.TgZ(7,"th"),s._uU(8,"Quantity"),s.qZA(),s.TgZ(9,"th"),s._uU(10,"Total"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(11,"tbody"),s.YNc(12,M,12,14,"tr",1),s.qZA(),s.qZA(),s.TgZ(13,"div"),s.TgZ(14,"span",2),s._uU(15,"Total: "),s.qZA(),s.TgZ(16,"span"),s._uU(17),s.ALo(18,"currency"),s.qZA(),s.qZA()),2&e&&(s.xp6(12),s.Q6J("ngForOf",t.bookings),s.xp6(5),s.Oqu(s.xi3(18,2,t.getAllBookingsTotal(t.bookings),null==t.bookings[0]?null:t.bookings[0].currencyCode)))},directives:[g.sg,i.yS],pipes:[g.H9],styles:[".table[_ngcontent-%COMP%]{table-layout:auto;width:100%;border-collapse:collapse}.table[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border:1px solid var(--secondary-color)}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:var(--space-1)}.table[_ngcontent-%COMP%]   .centered[_ngcontent-%COMP%]{text-align:center}"]}),e})();const L=function(){return[]},F=[{path:"",component:Z,canActivate:[c.WithAuthGuard]},{path:"itinerary/send",component:u,canActivate:[c.WithAuthGuard]},{path:"itinerary/view/:token",component:d},{path:"booking/send",component:h,canActivate:[c.WithAuthGuard]},{path:"pricing/send",component:(()=>{class e{constructor(e,t){this.projectService=e,this.dataService=t,this.bookings$=(0,m.of)([]),this.participantEmails$=(0,m.of)([]),this.activeProject$=this.projectService.getActiveProject(),this.bookings$=this.dataService.getFilteredBookings().pipe((0,A.U)(this.dataService.sortBookings)),this.participantEmails$=this.dataService.getFilteredBookings().pipe((0,f.M)(this.dataService.getParticipants()),(0,A.U)(([e,t])=>{const n=Array.from(new Set(e.reduce((e,t)=>[...e,...t.participants],[])));return t.filter(e=>n.includes(e.id)).map(e=>e.email)}))}handleSave(){}handleShare(e){}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.ProjectsService),s.Y36(l.ProjectDataService))},e.\u0275cmp=s.Xpm({type:e,selectors:[["app-price-report"]],decls:22,vars:12,consts:[[1,"centered-content","padded-container"],[1,"mb-2","mt-1"],["routerLink","../../../../","cta","tertiary"],[1,"ml-1","mr-1"],["routerLink","../../../","cta","tertiary"],["routerLink","../../","cta","tertiary"],[1,"mobile-ml-1","mobile-mr-1"],[1,"block","mb-3",3,"code","emails","makeLink","shareLink"],[3,"bookings"]],template:function(e,t){if(1&e&&(s.TgZ(0,"main",0),s._UZ(1,"app-authenticated-header"),s.TgZ(2,"header",1),s.TgZ(3,"span"),s.TgZ(4,"a",2),s._uU(5," Dashboard "),s.qZA(),s.qZA(),s.TgZ(6,"span",3),s._uU(7," / "),s.qZA(),s.TgZ(8,"span"),s.TgZ(9,"a",4),s._uU(10),s.ALo(11,"async"),s.qZA(),s.qZA(),s.TgZ(12,"span",3),s._uU(13," / "),s.qZA(),s.TgZ(14,"span"),s.TgZ(15,"a",5),s._uU(16,"Sharing center"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(17,"article",6),s.TgZ(18,"app-share-settings",7),s.NdJ("makeLink",function(){return t.handleSave()})("shareLink",function(e){return t.handleShare(e)}),s.ALo(19,"async"),s.qZA(),s._UZ(20,"app-price-report-visualization",8),s.ALo(21,"async"),s.qZA(),s.qZA()),2&e){let e;s.xp6(10),s.Oqu(null==(e=s.lcZ(11,4,t.activeProject$))?null:e.name),s.xp6(8),s.Q6J("code","")("emails",s.lcZ(19,6,t.participantEmails$)||s.DdM(10,L)),s.xp6(2),s.Q6J("bookings",s.lcZ(21,8,t.bookings$)||s.DdM(11,L))}},directives:[p.W,i.yS,O,j],pipes:[g.Ov],styles:[""]}),e})(),canActivate:[c.WithAuthGuard]},{path:"**",redirectTo:""}];let $=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.oAB({type:e}),e.\u0275inj=s.cJS({imports:[[r.m8,i.Bz.forChild(F),o.p,a.u5],i.Bz]}),e})()}}]);