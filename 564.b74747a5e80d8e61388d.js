(self.webpackChunkgoatzilla=self.webpackChunkgoatzilla||[]).push([[564],{1564:(e,t,i)=>{"use strict";i.r(t),i.d(t,{DataSharingModule:()=>ee});var n=i(9171),r=i(665),a=i(8583),o=i(4297),s=i(9645),c=i(784),l=i(7716),p=i(406),g=i(6226);let u=(()=>{class e{constructor(e){this.projectService=e,this.activeProject$=this.projectService.getActiveProject()}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(p.ProjectsService))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-share-itinerary"]],decls:20,vars:3,consts:[[1,"centered-content","padded-container"],[1,"mb-2","mt-1"],["routerLink","../../../../","cta","tertiary"],[1,"ml-1","mr-1"],["routerLink","../../../","cta","tertiary"],["routerLink","../../","cta","tertiary"]],template:function(e,t){if(1&e&&(l.TgZ(0,"main",0),l._UZ(1,"app-authenticated-header"),l.TgZ(2,"header",1),l.TgZ(3,"span"),l.TgZ(4,"a",2),l._uU(5," Dashboard "),l.qZA(),l.qZA(),l.TgZ(6,"span",3),l._uU(7," / "),l.qZA(),l.TgZ(8,"span"),l.TgZ(9,"a",4),l._uU(10),l.ALo(11,"async"),l.qZA(),l.qZA(),l.TgZ(12,"span",3),l._uU(13," / "),l.qZA(),l.TgZ(14,"span"),l.TgZ(15,"a",5),l._uU(16,"Sharing center"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(17,"article"),l.TgZ(18,"p"),l._uU(19,"Send itinerary information to participants"),l.qZA(),l.qZA(),l.qZA()),2&e){let e;l.xp6(10),l.Oqu(null==(e=l.lcZ(11,1,t.activeProject$))?null:e.name)}},directives:[g.W,n.yS],pipes:[a.Ov],styles:[""],changeDetection:0}),e})(),d=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-itinerary"]],decls:2,vars:0,template:function(e,t){1&e&&(l.TgZ(0,"p"),l._uU(1,"itinerary works!"),l.qZA())},styles:[""]}),e})();var h=i(8002);let m=(e=21)=>{let t="",i=crypto.getRandomValues(new Uint8Array(e));for(;e--;){let n=63&i[e];t+=n<36?n.toString(36):n<62?(n-26).toString(36).toUpperCase():n<63?"_":"-"}return t};var Z=i(6215),f=i(2340);let A=(()=>{class e{constructor(e){this.appRouter=e,this._items$=new Z.X({}),this._emails$=new Z.X({}),this.items$=this._items$.pipe((0,h.U)(e=>{const t=this.appRouter.getProjectId();return Object.values(e).filter(e=>e.projectId===t)})),this.emails$=this._emails$.pipe((0,h.U)(e=>{const t=this.appRouter.getProjectId();return Object.values(e).filter(e=>e.id===t)}));const t=JSON.parse(localStorage.getItem("sharedItems")||"{}");this._items$.next(t);const i=JSON.parse(localStorage.getItem("emails")||"{}");this._emails$.next(i)}deleteSharedItem(e){const t=Object.assign({},this._items$.getValue());delete t[e],localStorage.setItem("sharedItems",JSON.stringify(t)),this._items$.next(t)}deleteEmail(e){const t=Object.assign({},this._emails$.getValue());delete t[e],localStorage.setItem("emails",JSON.stringify(t)),this._emails$.next(t)}generatePriceReport(e){const t={id:m(),type:"price-report",emails:[],bookingIds:e,projectId:this.appRouter.getProjectId(),createdAt:(new Date).getTime()};return this._items$.next(Object.assign(Object.assign({},this._items$.getValue()),{[t.id]:t})),localStorage.setItem("sharedItems",JSON.stringify(this._items$.getValue())),t}generateEmail(e,t,i){const n=this.appRouter.getProjectId(),r=(new Date).getTime(),a={id:m(),projectId:n,shareId:e,sendAt:i||r,createdAt:r,recipients:t};return this._emails$.next(Object.assign(Object.assign({},this._emails$.getValue()),{[a.id]:a})),localStorage.setItem("emails",JSON.stringify(this._emails$.getValue())),a}getItemLink(e){const t=f.N.currentHost,i=this.appRouter.getProjectId();return"price-report"===e.type?`${t}/projects/${i}/sharing/pricing/${e.id}`:""}getSharedItem(e){return this._items$.getValue()[e]}}return e.\u0275fac=function(t){return new(t||e)(l.LFG(o.So))},e.\u0275prov=l.Yz7({token:e,factory:e.\u0275fac}),e})();var v=i(2608);let k=(()=>{class e{transform(e){switch(e){case"itinerary":return"Traveler itinerary";case"price-report":return"Price report";case"single-booking":return"Booking";default:return"Unknown"}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=l.Yjl({name:"sharingType",type:e,pure:!0}),e})();var T=i(7920);let b=(()=>{class e{constructor(e){this.datePipe=e}transform(e){const t=new Date,i=new Date(e),n=this.datePipe.transform(e,"short");return(0,T.Z)(t,i)?"Shipped at "+n:"Ships at "+n}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(a.uU,16))},e.\u0275pipe=l.Yjl({name:"emailStatus",type:e,pure:!1}),e})();function q(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",12),l.TgZ(1,"div",13),l.TgZ(2,"a",14),l._uU(3),l.ALo(4,"sharingType"),l.qZA(),l.TgZ(5,"button",15),l.NdJ("click",function(){const t=l.CHM(e).$implicit;return l.oxw(2).deleteItem(t.id)}),l._UZ(6,"svg-icon",16),l.TgZ(7,"span"),l._uU(8,"Revoke"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(9,"div",17),l.TgZ(10,"span",18),l._uU(11,"Created at:"),l.qZA(),l.TgZ(12,"span"),l._uU(13),l.ALo(14,"date"),l.qZA(),l.qZA(),l.qZA()}if(2&e){const e=t.$implicit,i=l.oxw(2);l.xp6(2),l.Q6J("href",i.getItemLink(e),l.LSH)("id",e.id),l.xp6(1),l.Oqu(l.lcZ(4,4,e.type)),l.xp6(10),l.Oqu(l.xi3(14,6,e.createdAt,"short"))}}function y(e,t){if(1&e&&(l.TgZ(0,"div"),l._uU(1),l.qZA()),2&e){const e=t.$implicit;l.xp6(1),l.hij(" ",e," ")}}const _=function(e){return["/","projects",e,"sharing"]};function x(e,t){if(1&e){const e=l.EpF();l.ynx(0),l.TgZ(1,"div",13),l.TgZ(2,"a",21),l._uU(3),l.ALo(4,"sharingType"),l.qZA(),l.TgZ(5,"button",15),l.NdJ("click",function(){l.CHM(e);const t=l.oxw().$implicit;return l.oxw(2).deleteEmail(t.id)}),l._UZ(6,"svg-icon",16),l.TgZ(7,"span"),l._uU(8,"Delete"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(9,"span",22),l._uU(10),l.ALo(11,"emailStatus"),l.qZA(),l.TgZ(12,"div",22),l.YNc(13,y,2,1,"div",23),l.qZA(),l.BQk()}if(2&e){const e=t.ngIf,i=l.oxw().$implicit,n=l.oxw().ngIf;l.xp6(2),l.Q6J("routerLink",l.VKq(9,_,n.id))("fragment",e.id),l.xp6(1),l.Oqu(l.lcZ(4,5,e.type)),l.xp6(7),l.hij(" ",l.lcZ(11,7,i.sendAt)," "),l.xp6(3),l.Q6J("ngForOf",i.recipients)}}function S(e,t){if(1&e&&(l.TgZ(0,"div",19),l.YNc(1,x,14,11,"ng-container",20),l.ALo(2,"async"),l.qZA()),2&e){const e=t.$implicit,i=l.oxw(2);l.xp6(1),l.Q6J("ngIf",l.lcZ(2,1,i.getItemById(e.shareId)))}}function U(e,t){if(1&e&&(l.TgZ(0,"main",1),l._UZ(1,"app-authenticated-header"),l.TgZ(2,"header",2),l.TgZ(3,"span"),l.TgZ(4,"a",3),l._uU(5," Dashboard "),l.qZA(),l.qZA(),l.TgZ(6,"span",4),l._uU(7," / "),l.qZA(),l.TgZ(8,"span"),l.TgZ(9,"a",5),l._uU(10),l.qZA(),l.qZA(),l.TgZ(11,"span",4),l._uU(12," / "),l.qZA(),l.TgZ(13,"h1",6),l._uU(14,"Sharing center"),l.qZA(),l.qZA(),l.TgZ(15,"article",7),l.TgZ(16,"section",8),l.TgZ(17,"h2",9),l._uU(18,"Links"),l.qZA(),l.YNc(19,q,15,9,"div",10),l.ALo(20,"async"),l.qZA(),l.TgZ(21,"section",8),l.TgZ(22,"h2",9),l._uU(23,"Emails"),l.qZA(),l.YNc(24,S,3,3,"div",11),l.ALo(25,"async"),l.qZA(),l.qZA(),l.qZA()),2&e){const e=t.ngIf,i=l.oxw();l.xp6(10),l.Oqu(e.name),l.xp6(9),l.Q6J("ngForOf",l.lcZ(20,3,i.items$)),l.xp6(5),l.Q6J("ngForOf",l.lcZ(25,5,i.emails$))}}let w=(()=>{class e{constructor(e,t,i){this.projectService=e,this.sharingService=t,this.snackbar=i,this.activeProject$=this.projectService.getActiveProject(),this.items$=this.sharingService.items$,this.emails$=this.sharingService.emails$}getItemLink(e){return this.sharingService.getItemLink(e)}getItemById(e){return this.items$.pipe((0,h.U)(t=>t.find(t=>t.id===e)))}deleteItem(e){this.sharingService.deleteSharedItem(e),this.snackbar.open("Link deleted","",{duration:3e3})}deleteEmail(e){this.sharingService.deleteEmail(e),this.snackbar.open("Email deleted","",{duration:3e3})}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(p.ProjectsService),l.Y36(A),l.Y36(o.ux))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-sharing-dashboard"]],decls:2,vars:3,consts:[["class","centered-content padded-container",4,"ngIf"],[1,"centered-content","padded-container"],[1,"mb-3","mt-1","flex","wrap","align-center"],["routerLink","../../","cta","tertiary"],[1,"ml-1","mr-1"],["routerLink","../","cta","tertiary"],[1,"h5"],[1,"flex","wrap","mobile-ml-2","mobile-mr-1"],[1,"width-5","mbl-width-12"],[1,"mb-2","h4"],["class","mb-3 flex column",4,"ngFor","ngForOf"],["class","mb-1 flex column",4,"ngFor","ngForOf"],[1,"mb-3","flex","column"],[1,"flex","align-center","wrap"],["target","_blank",1,"mr-3",3,"href","id"],[1,"ghost-button","flex","align-center","revoke",3,"click"],["key","remove",1,"mr-1"],[1,"small-text","mb-1"],[1,"mr-1"],[1,"mb-1","flex","column"],[4,"ngIf"],[1,"mr-3",3,"routerLink","fragment"],[1,"small-text"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(l.YNc(0,U,26,7,"main",0),l.ALo(1,"async")),2&e&&l.Q6J("ngIf",l.lcZ(1,1,t.activeProject$))},directives:[a.O5,g.W,n.yS,a.sg,v.bk],pipes:[a.Ov,k,a.uU,b],styles:[".revoke[_ngcontent-%COMP%]{color:darkred}"],changeDetection:0}),e})(),O=(()=>{class e{constructor(e){this.projectService=e,this.activeProject$=this.projectService.getActiveProject()}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(p.ProjectsService))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-share-booking"]],decls:20,vars:3,consts:[[1,"centered-content","padded-container"],[1,"mb-2","mt-1"],["routerLink","../../../../","cta","tertiary"],[1,"ml-1","mr-1"],["routerLink","../../../","cta","tertiary"],["routerLink","../../","cta","tertiary"]],template:function(e,t){if(1&e&&(l.TgZ(0,"main",0),l._UZ(1,"app-authenticated-header"),l.TgZ(2,"header",1),l.TgZ(3,"span"),l.TgZ(4,"a",2),l._uU(5," Dashboard "),l.qZA(),l.qZA(),l.TgZ(6,"span",3),l._uU(7," / "),l.qZA(),l.TgZ(8,"span"),l.TgZ(9,"a",4),l._uU(10),l.ALo(11,"async"),l.qZA(),l.qZA(),l.TgZ(12,"span",3),l._uU(13," / "),l.qZA(),l.TgZ(14,"span"),l.TgZ(15,"a",5),l._uU(16,"Sharing center"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(17,"article"),l.TgZ(18,"p"),l._uU(19,"Send an email with detailed booking information"),l.qZA(),l.qZA(),l.qZA()),2&e){let e;l.xp6(10),l.Oqu(null==(e=l.lcZ(11,1,t.activeProject$))?null:e.name)}},directives:[g.W,n.yS],pipes:[a.Ov],styles:[""],changeDetection:0}),e})();var I=i(5917),$=i(7057),j=i(4762),L=i(9112),C=i(4785),P=i(800),M=i(2458);function F(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"button",8),l.NdJ("click",function(){return l.CHM(e),l.oxw().makeLink.emit()}),l._UZ(1,"svg-icon",9),l.TgZ(2,"span"),l._uU(3,"Generate link"),l.qZA(),l.qZA()}}function J(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"button",10),l.NdJ("click",function(){return l.CHM(e),l.oxw().onCopy()}),l._UZ(1,"svg-icon",9),l.TgZ(2,"span"),l._uU(3,"Copy link"),l.qZA(),l.qZA()}if(2&e){const e=l.oxw();l.Q6J("cdkCopyToClipboard",e.link)}}function N(e,t){if(1&e&&(l.TgZ(0,"mat-option",22),l._uU(1),l.qZA()),2&e){const e=t.$implicit;l.Q6J("value",e),l.xp6(1),l.hij(" ",e," ")}}function E(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",23),l.TgZ(1,"span",24),l._uU(2),l.qZA(),l.TgZ(3,"button",25),l.NdJ("click",function(t){const i=l.CHM(e).$implicit;return l.oxw(2).removeRecipient(t,i)}),l._UZ(4,"svg-icon",26),l.qZA(),l.qZA()}if(2&e){const e=t.$implicit;l.xp6(2),l.Oqu(e)}}function Y(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",11),l.TgZ(1,"div",0),l.TgZ(2,"input",12,13),l.NdJ("keyup.enter",function(){l.CHM(e);const t=l.MAs(3),i=l.oxw();return i.handleEnter(i.emailFilter),t.focus()})("ngModelChange",function(t){return l.CHM(e),l.oxw().emailFilter=t}),l.qZA(),l.TgZ(4,"mat-autocomplete",14,15),l.NdJ("optionSelected",function(t){return l.CHM(e),l.oxw().addRecipient(t.option.value)}),l.YNc(6,N,2,2,"mat-option",16),l.ALo(7,"async"),l.qZA(),l.TgZ(8,"div",17),l.YNc(9,E,5,1,"div",18),l.qZA(),l._UZ(10,"div",19),l.TgZ(11,"div",20),l.TgZ(12,"button",21),l.NdJ("click",function(){l.CHM(e);const t=l.oxw();return t.handleShare(t.displayedRecipients)}),l._uU(13," Done "),l.qZA(),l.qZA(),l.qZA(),l.qZA()}if(2&e){const e=l.MAs(5),t=l.oxw();l.xp6(2),l.Q6J("ngModel",t.emailFilter)("matAutocomplete",e),l.xp6(4),l.Q6J("ngForOf",l.lcZ(7,4,t.recipients$)),l.xp6(3),l.Q6J("ngForOf",t.displayedRecipients)}}class R{constructor(e){this.snackbar=e,this.makeLink=new l.vpe,this.shareLink=new l.vpe,this.link="",this.emails=[],this.emailFilter$=new Z.X(""),this.showEmailSharing=!1,this._recipients$=new Z.X([]),this.recipients$=(0,L.aj)([this._recipients$,this.emailFilter$]).pipe((0,h.U)(([e,t])=>t?e.filter(e=>e&&e.toLowerCase().includes(t.toLowerCase())&&!this.displayedRecipients.includes(e)):[])),this.displayedRecipients=[],this.emailFilter=""}handleShare(e){this.shareLink.emit(e),this.showEmailSharing=!1}handleEnter(e){e&&(this.displayedRecipients=Array.from(new Set([...this.displayedRecipients,e])),this.emailFilter="")}removeRecipient(e,t){e.stopPropagation(),this.displayedRecipients=this.displayedRecipients.filter(e=>e!==t)}addRecipient(e){e&&(this.displayedRecipients.push(e),this.emailFilter="")}toggleEmailSharing(){this.showEmailSharing=!this.showEmailSharing}onCopy(){this.snackbar.open("Share link was copied!","",{duration:3e3})}ngOnInit(){this._recipients$.next(this.emails)}}R.\u0275fac=function(e){return new(e||R)(l.Y36(o.ux))},R.\u0275cmp=l.Xpm({type:R,selectors:[["app-share-settings"]],inputs:{link:"link",emails:"emails"},outputs:{makeLink:"makeLink",shareLink:"shareLink"},decls:10,vars:3,consts:[[1,"flex","wrap"],[1,"mr-3"],["cta","outlined","class","flex align-center justify-center mobile-mb-2",3,"click",4,"ngIf"],["cta","outlined","class","flex align-center justify-center mobile-mb-2",3,"cdkCopyToClipboard","click",4,"ngIf"],[1,"email-share"],["cta","outlined",1,"flex","align-center","justify-center",3,"click"],["key","share",1,"mr-1"],["class","email-share-toggable",4,"ngIf"],["cta","outlined",1,"flex","align-center","justify-center","mobile-mb-2",3,"click"],["key","link",1,"mr-1"],["cta","outlined",1,"flex","align-center","justify-center","mobile-mb-2",3,"cdkCopyToClipboard","click"],[1,"email-share-toggable"],["type","text","placeholder","Search recipients",1,"input",3,"ngModel","matAutocomplete","keyup.enter","ngModelChange"],["input",""],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"mt-2"],["class","flex align-center",4,"ngFor","ngForOf"],[1,"separator","mt-3"],[1,"mt-4"],["cta","outlined","secondary","",3,"click"],[3,"value"],[1,"flex","align-center"],[1,"mr-1"],[1,"ghost-button","remove-recipient",3,"click"],["key","remove"]],template:function(e,t){1&e&&(l.TgZ(0,"div",0),l.TgZ(1,"div",1),l.YNc(2,F,4,0,"button",2),l.YNc(3,J,4,1,"button",3),l.qZA(),l.TgZ(4,"div",4),l.TgZ(5,"button",5),l.NdJ("click",function(){return t.toggleEmailSharing()}),l._UZ(6,"svg-icon",6),l.TgZ(7,"span"),l._uU(8,"Share with"),l.qZA(),l.qZA(),l.YNc(9,Y,14,6,"div",7),l.qZA(),l.qZA()),2&e&&(l.xp6(2),l.Q6J("ngIf",!t.link),l.xp6(1),l.Q6J("ngIf",t.link),l.xp6(6),l.Q6J("ngIf",t.showEmailSharing))},directives:[a.O5,v.bk,C.i3,r.Fj,P.ZL,r.JJ,r.On,P.XC,a.sg,M.ey],pipes:[a.Ov],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   .email-share[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:relative}[_nghost-%COMP%]   .email-share-toggable[_ngcontent-%COMP%]{position:absolute;top:50px;background-color:#fff;min-width:300px;padding:var(--space-3);box-shadow:0 4px 8px 0 #0003}@media (max-width:48em){[_nghost-%COMP%]   .email-share-toggable[_ngcontent-%COMP%]{min-width:100%}}[_nghost-%COMP%]   .clear-date[_ngcontent-%COMP%], [_nghost-%COMP%]   .remove-recipient[_ngcontent-%COMP%]{color:var(--secondary-color)}"]}),(0,j.gn)([(0,o.GU)((e,t)=>{!1===e&&(t.emailFilter="",t.displayedRecipients=[])})],R.prototype,"showEmailSharing",void 0),(0,j.gn)([(0,o.GU)((e,t)=>{t.emailFilter$.next(e)})],R.prototype,"emailFilter",void 0);const Q=function(e){return["../../..","itinerary",e]};function D(e,t){if(1&e&&(l.TgZ(0,"tr"),l.TgZ(1,"td"),l.TgZ(2,"a",3),l._uU(3),l.qZA(),l.qZA(),l.TgZ(4,"td",4),l._uU(5),l.ALo(6,"currency"),l.qZA(),l.TgZ(7,"td",4),l._uU(8),l.qZA(),l.TgZ(9,"td",4),l._uU(10),l.ALo(11,"currency"),l.qZA(),l.qZA()),2&e){const e=t.$implicit,i=l.oxw();l.xp6(2),l.Q6J("routerLink",l.VKq(12,Q,e.id)),l.xp6(1),l.AsE("",e.provider," / ",e.confirmationNumber,""),l.xp6(2),l.hij(" ",l.xi3(6,6,e.price,e.currencyCode)," "),l.xp6(3),l.Oqu(e.participants.length),l.xp6(2),l.hij(" ",l.xi3(11,9,i.getBookingTotal(e),e.currencyCode)," ")}}let B=(()=>{class e{constructor(){this.bookings=[]}getBookingTotal(e){return(e.participants.length*e.price).toFixed(2)}getAllBookingsTotal(e){return e.reduce((e,t)=>e+t.participants.length*t.price,0).toFixed(2)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-price-report-visualization"]],inputs:{bookings:"bookings"},decls:19,vars:5,consts:[[1,"mb-4","table"],[4,"ngFor","ngForOf"],[1,"bold","mr-2"],["cta","tertiary",3,"routerLink"],[1,"centered"]],template:function(e,t){1&e&&(l.TgZ(0,"table",0),l.TgZ(1,"thead"),l.TgZ(2,"tr"),l.TgZ(3,"th"),l._uU(4,"Booking"),l.qZA(),l.TgZ(5,"th"),l._uU(6,"Price"),l.qZA(),l.TgZ(7,"th"),l._uU(8,"Quantity"),l.qZA(),l.TgZ(9,"th"),l._uU(10,"Total"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(11,"tbody"),l.YNc(12,D,12,14,"tr",1),l.qZA(),l.qZA(),l.TgZ(13,"div"),l.TgZ(14,"span",2),l._uU(15,"Total: "),l.qZA(),l.TgZ(16,"span"),l._uU(17),l.ALo(18,"currency"),l.qZA(),l.qZA()),2&e&&(l.xp6(12),l.Q6J("ngForOf",t.bookings),l.xp6(5),l.Oqu(l.xi3(18,2,t.getAllBookingsTotal(t.bookings),null==t.bookings[0]?null:t.bookings[0].currencyCode)))},directives:[a.sg,n.yS],pipes:[a.H9],styles:[".table[_ngcontent-%COMP%]{table-layout:auto;width:100%;border-collapse:collapse}.table[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border:1px solid var(--secondary-color)}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:var(--space-1)}.table[_ngcontent-%COMP%]   .centered[_ngcontent-%COMP%]{text-align:center}"]}),e})();const H=function(){return[]};function X(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"main",1),l._UZ(1,"app-authenticated-header"),l.TgZ(2,"header",2),l.TgZ(3,"span"),l.TgZ(4,"a",3),l._uU(5," Dashboard "),l.qZA(),l.qZA(),l.TgZ(6,"span",4),l._uU(7," / "),l.qZA(),l.TgZ(8,"span"),l.TgZ(9,"a",5),l._uU(10),l.ALo(11,"async"),l.qZA(),l.qZA(),l.TgZ(12,"span",4),l._uU(13," / "),l.qZA(),l.TgZ(14,"span"),l.TgZ(15,"a",6),l._uU(16,"Sharing center"),l.qZA(),l.qZA(),l.TgZ(17,"span",4),l._uU(18," / "),l.qZA(),l.TgZ(19,"h1",7),l._uU(20,"Price report"),l.qZA(),l.qZA(),l.TgZ(21,"article",8),l.TgZ(22,"app-share-settings",9),l.NdJ("makeLink",function(){const t=l.CHM(e).ngIf;return l.oxw().handleSave(t)})("shareLink",function(t){const i=l.CHM(e).ngIf;return l.oxw().handleShare(t,i)}),l.ALo(23,"async"),l.qZA(),l._UZ(24,"app-price-report-visualization",10),l.qZA(),l.qZA()}if(2&e){const e=t.ngIf,i=l.oxw();let n;l.xp6(10),l.Oqu(null==(n=l.lcZ(11,4,i.activeProject$))?null:n.name),l.xp6(12),l.Q6J("link",i.link)("emails",l.lcZ(23,6,i.participantEmails$)||l.DdM(8,H)),l.xp6(2),l.Q6J("bookings",e)}}let V=(()=>{class e{constructor(e,t,i,n){this.projectService=e,this.dataService=t,this.sharingService=i,this.snackbar=n,this.bookings$=(0,I.of)([]),this.participantEmails$=(0,I.of)([]),this.link="",this.item=void 0,this.activeProject$=this.projectService.getActiveProject(),this.bookings$=this.dataService.getFilteredBookings().pipe((0,h.U)(this.dataService.sortBookings)),this.participantEmails$=this.dataService.getFilteredBookings().pipe((0,$.M)(this.dataService.getParticipants()),(0,h.U)(([e,t])=>{const i=Array.from(new Set(e.reduce((e,t)=>[...e,...t.participants],[])));return t.filter(e=>i.includes(e.id)).map(e=>e.email)}))}handleSave(e){const t=this.sharingService.generatePriceReport(e.map(e=>e.id));this.item=t,this.link=this.sharingService.getItemLink(t)}handleShare(e,t){if(!this.item){const e=this.sharingService.generatePriceReport(t.map(e=>e.id));this.link=this.sharingService.getItemLink(e),this.item=e}this.sharingService.generateEmail(this.item.id,e),this.snackbar.open("Email sent!","",{duration:3e3})}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(p.ProjectsService),l.Y36(p.ProjectDataService),l.Y36(A),l.Y36(o.ux))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-share-price-report"]],decls:2,vars:3,consts:[["class","centered-content padded-container",4,"ngIf"],[1,"centered-content","padded-container"],[1,"mb-2","mt-1","flex","align-center","wrap","mobile-ml-1","mobile-mr-1"],["routerLink","../../../../","cta","tertiary"],[1,"ml-1","mr-1"],["routerLink","../../../","cta","tertiary"],["routerLink","../../","cta","tertiary"],[1,"h5"],[1,"mobile-ml-1","mobile-mr-1"],[1,"block","mb-3",3,"link","emails","makeLink","shareLink"],[3,"bookings"]],template:function(e,t){1&e&&(l.YNc(0,X,25,9,"main",0),l.ALo(1,"async")),2&e&&l.Q6J("ngIf",l.lcZ(1,1,t.bookings$))},directives:[a.O5,g.W,n.yS,R,B],pipes:[a.Ov],styles:[""]}),e})();var z=i(8513);function G(e,t){if(1&e&&(l.TgZ(0,"header",4),l.TgZ(1,"h1",5),l._uU(2,"Price report"),l.qZA(),l.TgZ(3,"span"),l._uU(4),l.ALo(5,"date"),l.qZA(),l.qZA()),2&e){const e=l.oxw(2);l.xp6(4),l.hij("Created at: ",l.lcZ(5,1,e.sharedItem.createdAt),"")}}function W(e,t){if(1&e&&(l.TgZ(0,"main",1),l._UZ(1,"app-public-header"),l.YNc(2,G,6,3,"header",2),l._UZ(3,"app-price-report-visualization",3),l.qZA()),2&e){const e=t.ngIf,i=l.oxw();l.xp6(2),l.Q6J("ngIf",i.sharedItem),l.xp6(1),l.Q6J("bookings",e)}}const K=[{path:"",component:w,canActivate:[s.WithAuthGuard]},{path:"itinerary/send",component:u,canActivate:[s.WithAuthGuard]},{path:"itinerary/view/:token",component:d},{path:"booking/send",component:O,canActivate:[s.WithAuthGuard]},{path:"pricing/send",component:V,canActivate:[s.WithAuthGuard]},{path:"pricing/:shareId",component:(()=>{class e{constructor(e,t,i){this.dataService=e,this.sharingService=t,this.appRouter=i,this.bookings$=(0,I.of)([]),this.bookings$=this.dataService.getBookings().pipe((0,h.U)(e=>{const t=this.appRouter.getShareId(),i=this.sharingService.getSharedItem(t);return this.sharedItem=i,e.filter(e=>i.bookingIds.includes(e.id))}))}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(p.ProjectDataService),l.Y36(A),l.Y36(o.So))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-price-report"]],decls:2,vars:3,consts:[["class","centered-content padded-container",4,"ngIf"],[1,"centered-content","padded-container"],["class","mb-3 mt-3 mobile-ml-1 mobile-mr-1",4,"ngIf"],[1,"mobile-ml-1","mobile-mr-1","block",3,"bookings"],[1,"mb-3","mt-3","mobile-ml-1","mobile-mr-1"],[1,"h3"]],template:function(e,t){1&e&&(l.YNc(0,W,4,2,"main",0),l.ALo(1,"async")),2&e&&l.Q6J("ngIf",l.lcZ(1,1,t.bookings$))},directives:[a.O5,z.E,B],pipes:[a.Ov,a.uU],styles:[""]}),e})()},{path:"**",redirectTo:""}];let ee=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({providers:[A,a.uU],imports:[[o.m8,n.Bz.forChild(K),c.p,r.u5],n.Bz]}),e})()}}]);